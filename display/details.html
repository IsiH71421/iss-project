<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ISS Pass Details</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

body {
  background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
  font-family: 'Roboto', sans-serif;
  color: #fff;
  text-align: center;
  padding: 3rem 1rem;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
}

h1 {
  font-size: 2.8rem;
  margin-bottom: 2rem;
  text-shadow: 0 0 8px rgba(0,0,0,0.5);
}

.details-container {
  background: rgba(255, 255, 255, 0.1);
  padding: 2rem;
  border-radius: 12px;
  max-width: 600px;
  width: 90%;
  text-align: left;
}

.details-container h2 {
  text-align: center;
  margin-bottom: 1rem;
}

.detail-item {
  margin: 0.5rem 0;
  font-size: 1.2rem;
}

button {
  margin-top: 2rem;
  background: rgba(255, 255, 255, 0.15);
  border: 2px solid #fff;
  border-radius: 12px;
  color: #fff;
  font-size: 1.25rem;
  font-weight: 700;
  padding: 1em 2.5em;
  cursor: pointer;
  width: 250px;
  max-width: 90vw;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
}

button:hover, button:focus {
  background: rgba(255, 255, 255, 0.35);
  box-shadow: 0 6px 20px rgba(255,255,255,0.6);
  transform: translateY(-3px);
  outline: none;
}

button:active {
  transform: translateY(0);
  box-shadow: 0 3px 10px rgba(255,255,255,0.3);
}
</style>
</head>
<body>

<h1>ISS Pass Details</h1>

<div class="details-container" id="details">
  Loading pass details...
</div>

<button onclick="window.history.back()">
    ⬅ Back
    <img src="../assets/qr_index.png" alt="Back QR" class="qr-code">
</button>

<script>
const urlParams = new URLSearchParams(window.location.search);
const pass_details = urlParams.get('details');

function formatTimestamp(utc) {
  const date = new Date(utc * 1000);
  return date.toLocaleString();
}

function showDetails(data) {
  const container = document.getElementById('details');
  container.innerHTML = `
    <h2>Pass Overview</h2>
    <div class="detail-item"><strong>Start:</strong> ${formatTimestamp(data.startUTC)} (${data.startAzCompass}, ${data.startEl}°)</div>
    <div class="detail-item"><strong>Maximum:</strong> ${formatTimestamp(data.maxUTC)} (${data.maxAzCompass}, ${data.maxEl}°)</div>
    <div class="detail-item"><strong>End:</strong> ${formatTimestamp(data.endUTC)} (${data.endAzCompass}, ${data.endEl}°)</div>
    <div class="detail-item"><strong>Magnitude:</strong> ${data.mag}</div>
    <div class="detail-item"><strong>Duration:</strong> ${data.duration} seconds</div>
    ${data.startVisibility ? `<div class="detail-item"><strong>Visibility Starts:</strong> ${formatTimestamp(data.startVisibility)}</div>` : ''}
  `;
}

if (pass_details) {
  try {
    const data = JSON.parse(decodeURIComponent(pass_details));
    showDetails(data);
  } catch (e) {
    document.getElementById('details').textContent = "❌ Failed to parse pass data.";
  }
} else {
  document.getElementById('details').textContent = "❌ No pass data provided.";
}
</script>

</body>
</html>
